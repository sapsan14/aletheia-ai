# =============================================================================
# Aletheia Backend — Configuration
# =============================================================================
# Values from .env (copy from .env.example). Defaults allow startup when vars unset.
# spring.config.import loads ../.env as properties; .env overrides defaults.
# =============================================================================

spring.application.name=aletheia-backend
spring.config.import=optional:file:../.env[.properties]

# --- Database ---
# H2 file-based for local dev (data persists in backend/data/; H2 console at /h2-console)
# Override with PostgreSQL via env, or jdbc:h2:mem:aletheia for in-memory
spring.datasource.url=${SPRING_DATASOURCE_URL:jdbc:h2:file:./data/aletheia;DB_CLOSE_DELAY=-1}
spring.datasource.username=${SPRING_DATASOURCE_USERNAME:sa}
spring.datasource.password=${SPRING_DATASOURCE_PASSWORD:}
spring.h2.console.enabled=${SPRING_H2_CONSOLE_ENABLED:true}
# Dialect: H2 (default) or PostgreSQL when using Postgres. Set via env when needed.
spring.jpa.database-platform=${SPRING_JPA_DATABASE_PLATFORM:org.hibernate.dialect.H2Dialect}
# Flyway owns schema; do not let Hibernate auto-create tables
spring.jpa.hibernate.ddl-auto=none

# --- Signing key ---
# PEM path (required for /ask and signing). Generate: openssl genpkey -algorithm RSA -out ai.key -pkeyopt rsa_keygen_bits:2048
# Set via env: AI_ALETHEIA_SIGNING_KEY_PATH. Empty = no signing (signature null).
ai.aletheia.signing.key-path=${AI_ALETHEIA_SIGNING_KEY_PATH:}

# --- PQC (post-quantum) signing (optional) ---
# When true and pqc-key-path set, a second ML-DSA (Dilithium) signature is produced over the same hash. See docs/en/PLAN_PQC.md.
ai.aletheia.signing.pqc-enabled=${AI_ALETHEIA_PQC_ENABLED:false}
# Path to ML-DSA private key (PEM or key file). Generate with Bouncy Castle PQC key gen utility (see PLAN_PQC or scripts).
ai.aletheia.signing.pqc-key-path=${AI_ALETHEIA_PQC_KEY_PATH:}

# --- TSA (Time-Stamp Authority) ---
# mock → MockTsaServiceImpl (deterministic, no network). real → RealTsaServiceImpl (HTTP to external TSA)
# Default: real with DigiCert TSA for production-grade timestamps
ai.aletheia.tsa.mode=${AI_ALETHEIA_TSA_MODE:real}
# TSA URL when mode=real. DigiCert is the default; alternatives: Sectigo, GlobalSign, FreeTSA
ai.aletheia.tsa.url=${AI_ALETHEIA_TSA_URL:http://timestamp.digicert.com}

# --- CORS ---
# Allowed origins for frontend (comma-separated). Default: Next.js dev server.
ai.aletheia.cors.allowed-origins=${CORS_ALLOWED_ORIGINS:http://localhost:3000}

# --- LLM (OpenAI) ---
# Set OPENAI_API_KEY for real calls; omit for mock-only (tests). OpenAiLLMClient loads only when key present.
ai.aletheia.llm.openai.api-key=${OPENAI_API_KEY:}
ai.aletheia.llm.openai.model=${OPENAI_MODEL:gpt-4}
ai.aletheia.llm.openai.temperature=${OPENAI_TEMPERATURE:1.0}
ai.aletheia.llm.openai.max-tokens=${OPENAI_MAX_TOKENS:2000}

# --- SpringDoc OpenAPI + Swagger UI ---
# API docs at /v3/api-docs, Swagger UI at /swagger-ui.html. show-actuator: include Actuator endpoints in Swagger.
springdoc.api-docs.path=${SPRINGDOC_API_DOCS_PATH:/v3/api-docs}
springdoc.swagger-ui.path=${SPRINGDOC_SWAGGER_UI_PATH:/swagger-ui.html}
springdoc.show-actuator=${SPRINGDOC_SHOW_ACTUATOR:false}

# --- SIEM integration ---
# Optional path for JSONL events. Empty = stdout.
ai.aletheia.siem.log-path=${ALETHEIA_SIEM_LOG_PATH:}
